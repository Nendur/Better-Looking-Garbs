# p5 headgear
5 = {
	0 = { # Imperial crown/Caliph turban
		factor = 100
		modifier = {
			factor = 0
			NOR = {
				real_tier = emperor
				spouse = {
					real_tier = emperor
					NOT = { trait = uncrowned }
				}
			}
		}
		modifier = {
			factor = 0
			OR = {
				AND = {
					has_game_rule = {
						name = martial_headgear
						value = on
					}
					in_command = yes
					war = yes
				}
				in_battle = yes
				in_siege = yes
				death_reason = death_battle
				is_tributary = yes
				trait = peasant_leader
				trait = heresiarch
				trait = leper
				trait = in_hiding
				AND = { trait = uncrowned is_feudal = yes }
				check_variable = { which = ca_headgear value = 2 }
			}
		}
		modifier = { #If you are a living Emperor and are not crowned, you don't wear a crown.
			factor = 0
			has_dlc = "Holy Fury" #Ignore Coronation triggers if Holy Fury is disabled.
			are_coronations_active_trigger = yes
			OR = {
				has_game_started = yes
				is_save_game = yes
			}
			real_tier = EMPEROR
			is_alive = yes
			is_feudal = yes
			religion_group = christian
			NOR = {
				trait = crowned_by_priest
				trait = crowned_by_bishop
				trait = crowned_by_pope
				trait = crowned_by_myself
			}
		}
		modifier = {
			factor = 0
			has_dlc = "Holy Fury" #Ignore Coronation triggers if Holy Fury is disabled.
			are_coronations_active_trigger = yes
			OR = {
				has_game_started = yes
				is_save_game = yes
			}
			NOT = { real_tier = EMPEROR }
			spouse = {
				real_tier = EMPEROR
				is_alive = yes
				is_feudal = yes
				religion_group = christian
				NOR = {
					trait = crowned_by_priest
					trait = crowned_by_bishop
					trait = crowned_by_pope
					trait = crowned_by_myself
				}
			}
		}
		modifier = {
			factor = 0
			is_nomadic = yes
			NOT = {
				population = 10000
			}
		}
		modifier = { #Nomads marrying lowly pagans should not give them Imperial crowns, unless the spouse has enough population to warrant it.
			factor = 0
			spouse = {
				is_nomadic = yes
				real_tier = EMPEROR
				NOT = {
					population = 10000
				}
			}
			is_ruler = yes
			lower_tier_than = EMPEROR
		}
		modifier = {
			factor = 0
			is_nomadic = yes
			NOR = {
				culture_group = altaic
			}
			NAND = { is_alive = yes is_variable_equal = { which = ca_headgear value = 1 } }
		}
		modifier = {
			factor = 0
			is_republic = yes
		}
		modifier = {
			factor = 0
			spouse = { is_republic = yes } #Dead wives of Patricians are nogovernment, thus they would wear crowns for being married to a King-tier.
			is_alive = no
			is_ruler = no
		}
	}

	1 = { # Royal crown/turban 1
		factor = 1
		modifier = {
			factor = 0
			NOR = {
				higher_real_tier_than = duke
				spouse = {
					higher_real_tier_than = duke
					NAND = { trait = uncrowned is_feudal = yes primary_title = { is_vice_royalty = no } }
				}
				has_minor_title = title_despot
			}
		}
		modifier = {
			factor = 0
			OR = {
				AND = { trait = uncrowned is_feudal = yes primary_title = { is_vice_royalty = no } }
				trait = in_hiding
				trait = peasant_leader
				trait = heresiarch
			}
		}
		modifier = { #If you are a living Emperor and are not crowned, you don't wear a crown.
			factor = 0
			has_dlc = "Holy Fury" #Ignore Coronation triggers if Holy Fury is disabled.
			are_coronations_active_trigger = yes
			OR = {
				has_game_started = yes
				is_save_game = yes
			}
			real_tier = KING
			is_alive = yes
			is_feudal = yes
			religion_group = christian
			NOR = {
				trait = crowned_by_priest
				trait = crowned_by_bishop
				trait = crowned_by_pope
				trait = crowned_by_myself
				primary_title = { is_vice_royalty = yes }
			}
		}
		modifier = {
			factor = 0
			has_dlc = "Holy Fury" #Ignore Coronation triggers if Holy Fury is disabled.
			are_coronations_active_trigger = yes
			OR = {
				has_game_started = yes
				is_save_game = yes
			}
			NOT = { real_tier = KING }
			spouse = {
				real_tier = KING
				is_alive = yes
				is_feudal = yes
				religion_group = christian
				NOR = {
					trait = crowned_by_priest
					trait = crowned_by_bishop
					trait = crowned_by_pope
					trait = crowned_by_myself
					primary_title = { is_vice_royalty = yes }
				}
			}
		}
		modifier = {
			factor = 0
			is_nomadic = yes
			NOT = {
				population = 5000
			}
		}
		modifier = { #Nomads marrying lowly pagans should not give them Imperial crowns unless proper population is met.
			factor = 0
			spouse = {
				is_nomadic = yes
				real_tier = KING
				NOT = {
					population = 5000
				}
			}
			is_ruler = yes
			lower_tier_than = KING
		}
		modifier = {
			factor = 0
			is_republic = yes
		}
		modifier = {
			factor = 0
			spouse = { is_republic = yes }
			is_alive = no
			is_ruler = no
		}
		modifier = {
			factor = 100
			is_alive = yes
			is_variable_equal = { which = ca_headgear value = 2 }
		}
	}

	2 = { # Royal crown/turban 2
		factor = 1
		modifier = {
			factor = 0
			NOR = {
				higher_real_tier_than = duke
				spouse = {
					higher_real_tier_than = duke
					NAND = { trait = uncrowned is_feudal = yes primary_title = { is_vice_royalty = no } }
				}
				has_minor_title = title_despot
			}
		}
		modifier = {
			factor = 0
			OR = {
				AND = { trait = uncrowned is_feudal = yes primary_title = { is_vice_royalty = no } }
				trait = in_hiding
				trait = peasant_leader
				trait = heresiarch
			}
		}
		modifier = { #If you are a living Emperor and are not crowned, you don't wear a crown.
			factor = 0
			has_dlc = "Holy Fury" #Ignore Coronation triggers if Holy Fury is disabled.
			are_coronations_active_trigger = yes
			OR = {
				has_game_started = yes
				is_save_game = yes
			}
			real_tier = KING
			is_alive = yes
			is_feudal = yes
			religion_group = christian
			NOR = {
				trait = crowned_by_priest
				trait = crowned_by_bishop
				trait = crowned_by_pope
				trait = crowned_by_myself
				primary_title = { is_vice_royalty = yes }
			}
		}
		modifier = {
			factor = 0
			has_dlc = "Holy Fury" #Ignore Coronation triggers if Holy Fury is disabled.
			are_coronations_active_trigger = yes
			OR = {
				has_game_started = yes
				is_save_game = yes
			}
			NOT = { real_tier = KING }
			spouse = {
				real_tier = KING
				is_alive = yes
				is_feudal = yes
				religion_group = christian
				NOR = {
					trait = crowned_by_priest
					trait = crowned_by_bishop
					trait = crowned_by_pope
					trait = crowned_by_myself
					primary_title = { is_vice_royalty = yes }
				}
			}
		}
		modifier = {
			factor = 0
			is_nomadic = yes
			NOT = {
				population = 5000
			}
		}
		modifier = { #Nomads marrying lowly pagans should not give them Imperial crowns unless proper population is met.
			factor = 0
			spouse = {
				is_nomadic = yes
				real_tier = KING
				NOT = {
					population = 5000
				}
			}
			is_ruler = yes
			lower_tier_than = KING
		}
		modifier = {
			factor = 0
			is_republic = yes
		}
		modifier = {
			factor = 0
			spouse = { is_republic = yes }
			is_alive = no
			is_ruler = no
		}
		modifier = {
			factor = 100
			is_alive = yes
			is_variable_equal = { which = ca_headgear value = 3 }
		}
	}

	3 = { # Royal crown/turban 3
		factor = 1
		modifier = {
			factor = 0
			NOR = {
				higher_real_tier_than = duke
				spouse = {
					higher_real_tier_than = duke
					NAND = { trait = uncrowned is_feudal = yes primary_title = { is_vice_royalty = no } }
				}
				has_minor_title = title_despot
				AND = { # Petty kings
					OR = {
						AND = { independent = yes real_tier = duke }
						spouse = { AND = { independent = yes real_tier = duke } }
					}
					OR = {
						culture_group = germanic
						culture_group = celtic
					}
				}
			}
		}
		modifier = {
			factor = 0
			OR = {
				AND = { trait = uncrowned is_feudal = yes primary_title = { is_vice_royalty = no } }
				trait = in_hiding
				trait = peasant_leader
				trait = heresiarch
			}
		}
		modifier = { #If you are a living Emperor and are not crowned, you don't wear a crown.
			factor = 0
			has_dlc = "Holy Fury" #Ignore Coronation triggers if Holy Fury is disabled.
			are_coronations_active_trigger = yes
			OR = {
				has_game_started = yes
				is_save_game = yes
			}
			real_tier = KING
			is_alive = yes
			is_feudal = yes
			religion_group = christian
			NOR = {
				trait = crowned_by_priest
				trait = crowned_by_bishop
				trait = crowned_by_pope
				trait = crowned_by_myself
				primary_title = { is_vice_royalty = yes }
			}
		}
		modifier = {
			factor = 0
			has_dlc = "Holy Fury" #Ignore Coronation triggers if Holy Fury is disabled.
			are_coronations_active_trigger = yes
			OR = {
				has_game_started = yes
				is_save_game = yes
			}
			NOT = { real_tier = KING }
			spouse = {
				real_tier = KING
				is_alive = yes
				is_feudal = yes
				religion_group = christian
				NOR = {
					trait = crowned_by_priest
					trait = crowned_by_bishop
					trait = crowned_by_pope
					trait = crowned_by_myself
					primary_title = { is_vice_royalty = yes }
				}
			}
		}
		modifier = {
			factor = 0
			is_nomadic = yes
			NOT = {
				population = 5000
			}
		}
		modifier = { #Nomads marrying lowly pagans should not give them Imperial crowns unless proper population is met.
			factor = 0
			spouse = {
				is_nomadic = yes
				real_tier = KING
				NOT = {
					population = 5000
				}
			}
			is_ruler = yes
			lower_tier_than = KING
		}
		modifier = {
			factor = 0
			is_republic = yes
		}
		modifier = {
			factor = 0
			spouse = { is_republic = yes }
			is_alive = no
			is_ruler = no
		}
		modifier = {
			factor = 100
			is_alive = yes
			is_variable_equal = { which = ca_headgear value = 4 }
		}
	}

	4 = { # Simple golden band/turban
		factor = 1
		modifier = {
			factor = 0
			NOR = {
				higher_real_tier_than = count
				spouse = { higher_real_tier_than = count }
				has_minor_title = title_prince
				has_minor_title = title_queen_mother
			}
		}
		modifier = {
			factor = 0
			is_republic = no
			is_nomadic = no
			NOT = { trait = uncrowned }
			OR = {
				AND = {
					higher_real_tier_than = DUKE
					OR = {
						NOT = { has_dlc = "Holy Fury" }
						are_coronations_active_trigger = no
						NOT = { religion_group = christian }
						trait = crowned_by_priest
						trait = crowned_by_bishop
						trait = crowned_by_pope
						trait = crowned_by_myself
						primary_title = { is_vice_royalty = yes }
						AND = {
							has_game_started = no
							is_save_game = no
						}
					}
				}
				spouse = {
					higher_real_tier_than = DUKE
					OR = {
						NOT = { has_dlc = "Holy Fury" }
						are_coronations_active_trigger = no
						NOT = { religion_group = christian }
						trait = crowned_by_priest
						trait = crowned_by_bishop
						trait = crowned_by_pope
						trait = crowned_by_myself
						primary_title = { is_vice_royalty = yes }
						AND = {
							has_game_started = no
							is_save_game = no
						}
					}
				}
			}
			NAND = { is_alive = yes is_variable_equal = { which = ca_headgear value = 5 } }
		}
		modifier = {
			factor = 0
			OR = {
				has_minor_title = title_despot
				trait = in_hiding
				trait = peasant_leader
				trait = heresiarch
			}
			NAND = { is_alive = yes is_variable_equal = { which = ca_headgear value = 5 } }
		}
		modifier = { # Petty kings
			factor = 0
			OR = {
				AND = { independent = yes real_tier = duke }
				spouse = { AND = { independent = yes real_tier = duke } }
			}
			OR = {
				culture_group = germanic
				culture_group = celtic
			}
			NAND = { is_alive = yes is_variable_equal = { which = ca_headgear value = 5 } }
		}
		modifier = {
			factor = 100
			is_alive = yes
			is_variable_equal = { which = ca_headgear value = 5 }
		}
	}

	5 = { # Common headgear 1 - hood
		factor = 1
		modifier = {
			factor = 0
			OR = {
				higher_real_tier_than = count
				spouse = { higher_real_tier_than = count }
				has_minor_title = title_prince
				has_minor_title = title_queen_mother
				is_or_was_offmap_power_ruler = yes
				AND = {
					is_ruler = yes
					is_female = no
					OR = {
						culture_group = celtic
						culture_group = germanic
					}
				}
			}
			NOR = {
				trait = in_hiding
				trait = peasant_leader
				trait = heresiarch
				trait = leper
			}
			NAND = { is_alive = yes is_variable_equal = { which = ca_headgear value = 6 } }
		}
		modifier = {
			factor = 100
			trait = leper
			OR = {
				likes_arabs = yes
				likes_iranians = yes
				likes_africans = yes
				blg_north_african = yes
			}
		}
		modifier = {
			factor = 0
			is_female = no
			NOT = { year = 950 }
			OR = {
				culture = frankish
				culture = occitan
			}
			OR = {
				real_tier = count
				spouse = { real_tier = count }
			}
		}
		modifier = { # Specific rules for frankish / Occitanian layering
			factor = 0
			has_dlc = "Holy Fury"
			is_female = yes
			OR = {
				culture = frankish
				culture = occitan
			}
			has_portrait_property = { layer = 32 index = 0 }
			has_portrait_property = { layer = 33 index = 0 }
		}
		modifier = {
			factor = 100
			is_alive = yes
			is_variable_equal = { which = ca_headgear value = 6 }
		}
	}

	6 = { # Common headgear 2 - hood
		factor = 1
		hide_layers = { 31 = { } }
		modifier = {
			factor = 0
			OR = {
				higher_real_tier_than = count
				spouse = { higher_real_tier_than = count }
				has_minor_title = title_prince
				has_minor_title = title_queen_mother
				is_or_was_offmap_power_ruler = yes
			}
			NOR = {
				trait = in_hiding
				trait = peasant_leader
				trait = heresiarch
			}
			NAND = { is_alive = yes is_variable_equal = { which = ca_headgear value = 7 } }
		}
		modifier = {
			factor = 0
			is_female = no
			OR = {
				culture = frankish
				culture = occitan
			}
			OR = {
				real_tier = count
				spouse = { real_tier = count }
			}
		}
		modifier = { # Specific rules for frankish / Occitanian layering
			factor = 0
			has_dlc = "Holy Fury"
			is_female = yes
			OR = {
				culture = frankish
				culture = occitan
			}
			has_portrait_property = { layer = 32 index = 0 }
			has_portrait_property = { layer = 33 index = 0 }
		}
		modifier = {
			factor = 100
			is_alive = yes
			is_variable_equal = { which = ca_headgear value = 7 }
		}
	}

	7 = { # Common headgear 3 - Former Red hat
		factor = 1
		hide_layers = { 31 = { } }
		modifier = {
			factor = 0
			OR = {
				higher_real_tier_than = count
				spouse = { higher_real_tier_than = count }
				has_minor_title = title_prince
				has_minor_title = title_queen_mother
				is_or_was_offmap_power_ruler = yes
			}
			NOR = {
				trait = in_hiding
				trait = peasant_leader
				trait = heresiarch
			}
			NAND = { is_alive = yes is_variable_equal = { which = ca_headgear value = 8 } }
		}
		modifier = {
			factor = 0
			is_female = no
			OR = {
				culture = frankish
				culture = occitan
			}
			OR = {
				real_tier = count
				spouse = { real_tier = count }
			}
		}
		modifier = { # Specific rules for frankish / Occitanian layering
			factor = 0
			has_dlc = "Holy Fury"
			is_female = yes
			OR = {
				culture = frankish
				culture = occitan
			}
			has_portrait_property = { layer = 32 index = 0 }
			has_portrait_property = { layer = 33 index = 0 }
		}
		modifier = {
			factor = 100
			is_alive = yes
			is_variable_equal = { which = ca_headgear value = 8 }
		}
	}

	8 = { # Common headgear 4 - hood
		factor = 1
		hide_layers = { 31 = { } }
		modifier = {
			factor = 0
			OR = {
				higher_real_tier_than = count
				spouse = { higher_real_tier_than = count }
				has_minor_title = title_prince
				has_minor_title = title_queen_mother
				is_or_was_offmap_power_ruler = yes
			}
			NOR = {
				trait = in_hiding
				trait = peasant_leader
				trait = heresiarch
			}
			NAND = { is_alive = yes is_variable_equal = { which = ca_headgear value = 9 } }
		}
		modifier = {
			factor = 0
			is_female = no
			OR = {
				culture = frankish
				culture = occitan
			}
			OR = {
				real_tier = count
				spouse = { real_tier = count }
			}
		}
		modifier = { # Specific rules for frankish / Occitanian layering
			factor = 0
			has_dlc = "Holy Fury"
			is_female = yes
			OR = {
				culture = frankish
				culture = occitan
			}
			has_portrait_property = { layer = 32 index = 0 }
			has_portrait_property = { layer = 33 index = 0 }
		}
		modifier = {
			factor = 100
			is_alive = yes
			is_variable_equal = { which = ca_headgear value = 9 }
		}
	}

	9 = { # Shady headgear
		factor = 3
		hide_layers = { 31 = { } } #Veil overload.
		hide_layers = { 32 = { } }
		hide_layers = { 33 = { } }
		modifier = {
			factor = 0
			OR = {
				higher_real_tier_than = duke
				spouse = { higher_real_tier_than = duke }
			}
			NOR = {
				trait = in_hiding
				trait = peasant_leader
				trait = heresiarch
				trait = leper
			}
			NAND = { is_alive = yes is_variable_equal = { which = ca_headgear value = 10 } }
		}
		modifier = {
			factor = 0
			NOR = {
				has_job_title = job_spymaster
				trait = in_hiding
				trait = leper
			}
			OR = {
				real_tier = duke
				NOT = { intrigue = 16 }
			}
			NAND = { is_alive = yes is_variable_equal = { which = ca_headgear value = 10 } }
		}
		modifier = {
			factor = 33
			OR = {
				has_job_title = job_spymaster
				trait = leper
			}
		}
		modifier = {
			factor = 100
			is_alive = yes
			is_variable_equal = { which = ca_headgear value = 10 }
		}
	}

	10 = { # Martial headgear
		factor = 100
		modifier = {
			factor = 0
			OR = {
				higher_real_tier_than = duke
				spouse = { higher_real_tier_than = duke }
				AND = {
					real_tier = duke
					primary_title = { mercenary = no }
				}
			}
			NOR = {
				trait = uncrowned
			}
			NAND = { is_alive = yes is_variable_equal = { which = ca_headgear value = 11 } }
		}
		modifier = {
			factor = 0
			NOR = {
				AND = {
					in_command = yes
					OR = {
						war = yes
						liege = { war = yes }
						is_ruler = no
					}
				}
				has_job_title = job_marshal
				in_battle = yes
				in_siege = yes
				death_reason = death_battle
				#death_reason = death_duel
				primary_title = { mercenary = yes }
			}
			NAND = { is_alive = yes is_variable_equal = { which = ca_headgear value = 11 } }
		}
		modifier = {
			factor = 0
			has_game_rule = {
				name = martial_headgear
				value = off
			}
		}
	}

	11 = { # Blank
		factor = 4
		modifier = {
			factor = 0
			OR = {
				higher_real_tier_than = count
				spouse = { higher_real_tier_than = count }
				has_minor_title = title_prince
				has_minor_title = title_queen_mother
			}
			NOR = {
				trait = in_hiding
				trait = peasant_leader
				trait = heresiarch
				employer = { government = order_government }
			}
			NAND = { is_alive = yes is_variable_equal = { which = ca_headgear value = 12 } }
		}
		modifier = {
			factor = 0.1
			OR = {
				true_religion_group = muslim
				true_religion_group = jewish_group
			}
		}
		modifier = {
			factor = 20
			trait = shieldmaiden
		}
		modifier = {
			factor = 100
			employer = { government = order_government }
			in_command = no
		}
		modifier = {
			factor = 1000
			is_alive = yes
			is_variable_equal = { which = ca_headgear value = 12 }
		}
	}

	12 = { # royal war helm
		factor = 100
		modifier = {
			factor = 0
			NOR = {
				AND = {
					in_command = yes
					OR = {
						war = yes
						liege = { war = yes }
					}
				}
				in_battle = yes
				in_siege = yes
				death_reason = death_battle
				#death_reason = death_duel
			}
			NAND = { is_alive = yes is_variable_equal = { which = ca_headgear value = 13 } }
		}
		modifier = {
			factor = 0
			NOR = {
				higher_real_tier_than = duke
				spouse = { higher_real_tier_than = duke }
			}
		}
		modifier = {
			factor = 0
			is_nomadic = yes
			NOR = {
				real_tier = emperor
				spouse = { real_tier = emperor }
			}
		}
		modifier = {
			factor = 0
			trait = uncrowned
			is_feudal = yes
			primary_title = { is_vice_royalty = no }
		}
		modifier = {
			factor = 0
			spouse = { trait = uncrowned is_feudal = yes primary_title = { is_vice_royalty = no } }
			NOT = { higher_real_tier_than = duke }
		}
		modifier = {
			factor = 0
			has_dlc = "Holy Fury" #Ignore Coronation triggers if Holy Fury is disabled.
			OR = {
				has_game_started = yes
				is_save_game = yes
			}
			is_alive = yes
			is_feudal = yes
			higher_real_tier_than = duke
			religion_group = christian
			NOR = {
				trait = crowned_by_priest
				trait = crowned_by_bishop
				trait = crowned_by_pope
				trait = crowned_by_myself
				primary_title = { is_vice_royalty = yes }
			}
		}
		modifier = {
			factor = 0
			has_dlc = "Holy Fury" #Ignore Coronation triggers if Holy Fury is disabled.
			OR = {
				has_game_started = yes
				is_save_game = yes
			}
			NOT = { higher_real_tier_than = duke }
			spouse = {
				higher_real_tier_than = duke
				is_alive = yes
				is_feudal = yes
				religion_group = christian
				NOR = {
					trait = crowned_by_priest
					trait = crowned_by_bishop
					trait = crowned_by_pope
					trait = crowned_by_myself
					primary_title = { is_vice_royalty = yes }
				}
			}
		}
		modifier = {
			factor = 0
			has_game_rule = {
				name = martial_headgear
				value = off
			}
		}
	}

	13 = { # ducal war helm
		factor = 100
		modifier = {
			factor = 0
			NOR = {
				AND = {
					in_command = yes
					OR = {
						war = yes
						liege = { war = yes }
					}
				}
				in_battle = yes
				in_siege = yes
				has_job_title = job_marshal
				death_reason = death_battle
				#death_reason = death_duel
				AND = {
					government = order_government
					in_command = yes
				}
			}
			NAND = { is_alive = yes is_variable_equal = { which = ca_headgear value = 14 } }
		}
		modifier = {
			factor = 0
			NOR = {
				higher_real_tier_than = count
				spouse = { higher_real_tier_than = count }
			}
		}
		modifier = {
			factor = 0
			has_game_rule = {
				name = martial_headgear
				value = off
			}
		}
	}

	14 = { # Chinese war gear
		factor = 0
	}
}
